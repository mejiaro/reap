<%= render PhlexUI::Dialog.new(open: true, data: { controller: "custom-dialog" }) do %>
  <%= render PhlexUI::Dialog::Trigger.new(class: "hidden", data: { custom_dialog_target: "trigger" }) do %>
    <%= render PhlexUI::Button.new { "Open Dialog" } %>
  <% end %>
  <%= render PhlexUI::Dialog::Content.new(class: "bg-white") do %>
    <%= turbo_frame_tag :modal do %>
      <%= form_with url: workspace_project_assigned_tasks_path(project), method: :post, scope: assigned_task do |form| %>
        <div class="flex flex-col gap-y-4">
          <span class="font-semibold text-gray-600 text-lg">Add task to <%= project.name %></span>
          <%= content_tag(:div, class: "flex flex-col gap-y-4") do %>
            <%= render PhlexUI::Form::Item.new do  %>
              <%= render PhlexUI::Label.new { "Select task" } %>
              <div class="flex flex-row gap-x-4">
                <%= render PhlexUI::Select::Builder.new(assigned_task, "task_id", collection: unassigned_tasks.map { |task| [task.name, task.id] }, placeholder: "Select task", trigger_attrs: { class: "!border-gray-200" }) %>
              </div>
              <% assigned_task.errors.full_messages_for(:task_id).each do |message|%>
                <%= render PhlexUI::InputError.new(class: "w-full text-red-600 italic text-xs") { message }  %>
              <% end %>
            <% end %>
            <%= render PhlexUI::Form::Item.new(class: "flex flex-col") do  %>
              <%= render PhlexUI::Label.new { "Billable Rate (per hour) (NOK)" } %>
              <%= render PhlexUI::Hint.new { "This is optional, otherwise Project rate should be applied" } %>
              <%= form.text_field :rate_nok, class: "border-gray-200 rounded-md" %>
            <% end %>
          <% end %>
          <div class="mt-4 w-full">
            <%= render ButtonComponent.new(type: :submit, class: "w-full") { "Add" } %>
          </div>
        </div>
      <% end %>
      <%= render PhlexUI::Dialog::Footer.new(class: "mt-4 pt-4 border-t border-gray-100") do %>
        <div class="py-2 font-medium flex flex-row gap-x-1 justify-end text-sm">
          <span>Can't find what you're looking for?</span>
          <%= render ButtonComponent.new(path: new_modal_workspace_project_tasks_path(project), method: :post, variant: :link, class!: "underline text-primary") do %>
            <span class="mr-2">Add New</span>
          <% end %>
        </div>
      <% end %>
    <% end %>
  <% end %>
<% end %>
